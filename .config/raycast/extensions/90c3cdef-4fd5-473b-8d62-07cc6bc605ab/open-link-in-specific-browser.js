"use strict";var X=Object.defineProperty;var Dt=Object.getOwnPropertyDescriptor;var Nt=Object.getOwnPropertyNames;var Mt=Object.prototype.hasOwnProperty;var _t=(e,t)=>{for(var n in t)X(e,n,{get:t[n],enumerable:!0})},Gt=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Nt(t))!Mt.call(e,o)&&o!==n&&X(e,o,{get:()=>t[o],enumerable:!(i=Dt(t,o))||i.enumerable});return e};var Wt=e=>Gt(X({},"__esModule",{value:!0}),e);var $t={};_t($t,{default:()=>xt});module.exports=Wt($t);var Tt=require("@raycast/api"),wt=require("react");var m=require("@raycast/api");var rt=require("net"),E=e=>!(e!=null&&String(e).length>0);function at(e){return e.slice(0,7)=="mailto:"&&J(e.slice(7))}function st(e){return/^\w+((.\w+)|(-\w+))@[A-Za-z\d]+((.|-)[A-Za-z\d]+).[A-Za-z\d]+$/.test(e)}var ct=/;|,/;function J(e){if(E(e))return!1;let t=e.split(ct),n=!0;return t.forEach((i,o)=>{n=n&&(E(i)&&o==t.length-1||st(i))}),n}function q(e){let t=e.split(ct),n="";return t.map(i=>{st(i)&&(n=n+i+";")}),"mailto:"+n}function mt(e){return/^(http|https|ftp):\/\/((?:[\w-]+\.)+[a-z\d]+)((?:\/[^/?#]*)+)?(\?[^#]+)?(#.+)?$/i.test(e)||(0,rt.isIPv4)(e)}var O=(e,t)=>/^https?:\/\//g.test(t)?t:`${e}${encodeURIComponent(t)}`,lt=(e,t)=>/^http:\/\//g.test(t)?t:`${e}${t}`;var c=require("@raycast/api");var S={google:"https://google.com/search?q=",bing:"https://www.bing.com/search?q=",baidu:"https://www.baidu.com/s?wd=",brave:"https://search.brave.com/search?q=",duckduckgo:"https://duckduckgo.com/?q="},U=[{path:"/Applications/Safari.app",type:"Browser",rank:1},{path:"/System/Volumes/Preboot/Cryptexes/App/System/Applications/Safari.app",type:"Browser",rank:1},{path:"/Applications/Google Chrome.app",type:"Browser",rank:2},{path:"/Applications/Microsoft Edge.app",type:"Browser",rank:3},{path:"/Applications/Firefox.app",type:"Browser",rank:4},{path:"/Applications/Opera.app",type:"Browser",rank:5},{path:"/Applications/Vivaldi.app",type:"Browser",rank:6},{path:"/Applications/Brave Browser.app",type:"Browser",rank:7},{path:"/Applications/Orion.app",type:"Browser",rank:8},{path:"/Applications/Arc.app",type:"Browser",rank:9},{path:"/Applications/DuckDuckGo.app",type:"Browser",rank:10},{path:"/Applications/MenubarX.app",type:"Browser",rank:11},{path:"/Applications/SigmaOS.app",type:"Browser",rank:12},{path:"/Applications/Slidepad.app",type:"Browser",rank:13},{path:"/Applications/Min.app",type:"Browser",rank:14},{path:"/System/Applications/Mail.app",type:"Email Client",rank:101},{path:"/Applications/Spark.app",type:"Email Client",rank:102},{path:"/Applications/Microsoft Outlook.app",type:"Email Client",rank:103},{path:"/Applications/Airmail.app",type:"Email Client",rank:104},{path:"/Applications/Mimestream.app",type:"Email Client",rank:105},{path:"/Applications/Edison Mail.app",type:"Email Client",rank:106},{path:"/Applications/Downie 4.app",type:"Other",rank:201},{path:"/Applications/IINA.app",type:"Other",rank:202},{path:"/Applications/Motrix.app",type:"Other",rank:203},{path:"/Applications/Thunder.app",type:"Other",rank:204}];var N=e=>{switch(e.type){case"Text":return"Search \u300C "+z(e)+" \u300D in";case"URL":return"Open \u300C "+z(e)+" \u300D in";case"Email":return"Email \u300C "+z(e)+" \u300D in";case"":return"Detect link by pressing \u23CE"}},z=e=>{let t=e.content.length>=40?" ...":"";return e.content.substring(0,40)+t},M=(e,t)=>{switch(e.type){case"Text":return"Search in "+t;case"URL":return"Open in "+t;case"Email":return"Email in "+t;case"":return"Detect Link"}},_=e=>{switch(e.type){case"Text":return c.Icon.MagnifyingGlass;case"URL":return c.Icon.Link;case"Email":return c.Icon.Envelope;case"":return c.Icon.TwoArrowsClockwise}};async function ut(e,t,n){if(e.type!=""){switch(e.type){case"URL":await(0,c.showHUD)("Open link in "+t.name);break;case"Text":await(0,c.showHUD)("Search text by "+(0,c.getPreferenceValues)().surfEngine+" in "+t.name);break;case"Email":await(0,c.showHUD)("Send e-mail in "+t.name);break}await Ht(K(e),t.path),await(0,c.popToRoot)({clearSearchBar:!0})}else n(Date.now())}async function Ht(e,t){try{t==="/Applications/MenubarX.app"?await(0,c.open)(`menubarx://open/?xurl=${e}&xwidth=375&xheight=667&xbar=1`):await(0,c.open)(e,t)}catch{await(0,c.showHUD)("Error Input!")}}function K(e){switch(e.type){case"Email":return e.content;case"URL":return e.content;default:{switch((0,c.getPreferenceValues)().surfEngine){case"Google":return O(S.google,e.content);case"Bing":return O(S.bing,e.content);case"Baidu":return O(S.baidu,e.content);case"Brave":return O(S.brave,e.content);case"DuckDuckGo":return O(S.duckduckgo,e.content)}return O(S.google,e.content)}}}async function ft(e,t,n){n.map((i,o)=>{if(i.name==t.name)switch(e.type){case"Text":{if(n.filter(a=>a.path!==t.path&&a.rankText>=t.rankText).length==0)break;let p=0;n.forEach(a=>[p=p+a.rankText]),n[o].rankText=Math.floor((n[o].rankText+1-n[o].rankText/p)*100)/100;break}case"Email":{if(n.filter(a=>a.path!==t.path&&a.rankEmail>=t.rankEmail).length==0)break;let p=0;n.forEach(a=>[p=p+a.rankEmail]),n[o].rankEmail=Math.floor((n[o].rankEmail+1-n[o].rankEmail/p)*100)/100;break}case"URL":{if(n.filter(a=>a.path!==t.path&&a.rankURL>=t.rankURL).length==0)break;let p=0;n.forEach(a=>[p=p+a.rankURL]),n[o].rankURL=Math.floor((n[o].rankURL+1-n[o].rankURL/p)*100)/100;break}}}),Z(n,e),await c.LocalStorage.setItem("Preferred App",JSON.stringify(n))}async function ht(e,t){return t.map(n=>{n.path==e.path&&(n.rankText=1),n.rankURL=1,n.rankEmail=1}),t.sort(function(n,i){return i.name.toUpperCase()<n.name.toUpperCase()?1:-1}),await c.LocalStorage.setItem("Preferred App",JSON.stringify(t)),[...t]}async function At(e){return e.forEach(t=>{t.rankText=1,t.rankURL=1,t.rankEmail=1}),e.sort(function(t,n){return n.name.toUpperCase()<t.name.toUpperCase()?1:-1}),await c.LocalStorage.setItem("Preferred App",JSON.stringify(e)),[...e]}function Z(e,t){switch((0,c.getPreferenceValues)().sortBy){case"Rank":return e.sort(function(n,i){return Vt(t,n,i)});case"Name+":return e.sort(function(n,i){return i.name.toUpperCase()<n.name.toUpperCase()?1:-1});case"Name-":return e.sort(function(n,i){return i.name.toUpperCase()>n.name.toUpperCase()?1:-1});default:return e}}function Vt(e,t,n){switch(e.type){case"Email":return n.rankEmail-t.rankEmail;case"URL":return(n.rankURL-t.rankURL)*.75+(n.rankText-t.rankText)*.25;case"Text":return(n.rankText-t.rankText)*.75+(n.rankURL-t.rankURL)*.25;case"":return 0}}var gt=require("@raycast/api");var s=require("@raycast/api");var h=require("@raycast/api"),b=require("react/jsx-runtime");function P(){return(0,b.jsxs)(h.ActionPanel.Section,{children:[(0,b.jsx)(h.Action,{icon:h.Icon.Gear,title:"Open Command Preferences",shortcut:{modifiers:["shift","cmd"],key:","},onAction:h.openCommandPreferences}),(0,b.jsx)(h.Action,{icon:h.Icon.Gear,title:"Open Extension Preferences",shortcut:{modifiers:["shift","cmd"],key:"."},onAction:h.openExtensionPreferences})]})}var T=require("@raycast/api");var Lt=require("react/jsx-runtime");function kt(e){let{curApp:t,setRefresh:n}=e;return(0,Lt.jsx)(T.Action,{title:"Add to Favorites",icon:T.Icon.Star,shortcut:{modifiers:["cmd"],key:"s"},onAction:async()=>{let i=await T.LocalStorage.getItem("Preferred App"),o=typeof i=="string"?JSON.parse(i):[];o.push({bundleId:t.bundleId,name:t.name,path:t.path,rankText:1,rankURL:1,rankEmail:1}),await T.LocalStorage.setItem("Preferred App",JSON.stringify(o)),n(Date.now())}})}var A=require("react");var G=require("@raycast/api");var It=require("net");var B=class{constructor(t="",n="",i=""){this.content=t,this.source=n,this.type=i}setContent(t=""){return this.content=t,this}setSource(t=""){return this.source=t,this}setType(){let t=this.content.trim();if(E(t))this.content="",this.source="",this.type="";else if(at(t))this.content=q(t.slice(7)),this.type="Email";else if(J(t))this.content=q(t),this.type="Email";else if(mt(t)){let n;(0,It.isIP)(t)?t=="127.0.0.1"?n="http://www."+t:n=lt("http://",t):n=/^https?:\/\//g.test(t)?t:"https://"+t,this.content=n,this.type="URL"}else this.content=t,this.type="Text";return this}},Rt=async()=>{let e=await G.Clipboard.readText();return typeof e>"u"?"":e},dt=()=>{let e=new B;return(0,G.getSelectedText)().then(async t=>E(t)?e.setContent(String(await Rt())).setSource("Clipboard").setType():e.setContent(t.substring(0,9999)).setSource("Selected").setType()).catch(async()=>e.setContent(String(await Rt())).setSource("Clipboard").setType()).then(t=>E(t.content)?e.setContent("").setSource("").setType():e).catch(()=>e.setContent("").setSource("").setType())};var k=require("@raycast/api");var Et=e=>{let[t,n]=(0,A.useState)(new B),i=(0,A.useCallback)(async()=>{let o=await dt();o.type==""?await(0,k.showToast)(k.Toast.Style.Failure,"Nothing is detected from Selected or Clipboard!"):n(o)},[e]);return(0,A.useEffect)(()=>{i()},[i]),{itemInput:t}},yt=(e,t)=>{let[n,i]=(0,A.useState)([]),[o,r]=(0,A.useState)([]),[p,a]=(0,A.useState)([]),[L,R]=(0,A.useState)(!0),{showBrowser:y,showEmail:g,showOther:Ct}=(0,k.getPreferenceValues)(),et=(0,A.useCallback)(async()=>{R(!0);let Ut=await(0,k.getApplications)(),nt=await k.LocalStorage.getItem("Preferred App"),it=typeof nt=="string"?JSON.parse(nt):[],bt=it.map(l=>l.path),Bt=U.map(l=>{switch(l.type){case"Browser":{if(y)return l.path;break}case"Email Client":{if(g)return l.path;break}case"Other":{if(Ct)return l.path;break}}}),$=[],ot=[];Ut.forEach(l=>{let C=Bt.indexOf(l.path),pt=bt.includes(l.path);C!==-1&&!pt?$.push({bundleId:l.bundleId,name:l.name,path:l.path,rankText:U[C].rank,rankURL:U[C].rank,rankEmail:U[C].rank}):pt||ot.push({bundleId:l.bundleId,name:l.name,path:l.path,rankText:1,rankURL:1,rankEmail:1})}),$.sort((l,C)=>l.rankURL-C.rankURL),r(Z(it,e)),i($),a(ot),R(!1)},[e,t]);return(0,A.useEffect)(()=>{et()},[et]),{buildInApps:n,customApps:o,otherApps:p,loading:L}},Q=async(e,t,n,i,o,r)=>{await(0,k.confirmAlert)({icon:e,title:t,message:n,primaryAction:{title:i,onAction:o},dismissAction:{title:"Cancel",onAction:()=>r}})};var u=require("react/jsx-runtime");function W(e){let{isCustom:t,index:n,openLinkApplication:i,openLinkApplications:o,itemInput:r,setRefresh:p}=e;return(0,u.jsxs)(s.ActionPanel,{children:[(0,u.jsx)(s.Action,{title:M(r,i.name),icon:_(r),onAction:async()=>{t&&await ft(r,i,o),await ut(r,i,p)}}),r.type!==""&&(0,u.jsx)(s.Action,{title:"Detect Link",shortcut:{modifiers:["cmd"],key:"d"},icon:s.Icon.Repeat,onAction:()=>{p(Date.now())}}),(0,u.jsxs)(s.ActionPanel.Section,{children:[!t&&(0,u.jsx)(kt,{curApp:i,setRefresh:p}),t&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(s.Action,{title:"Remove from Favorites",icon:s.Icon.StarDisabled,shortcut:{modifiers:["ctrl"],key:"x"},onAction:async()=>{let a=[...o];a.splice(n,1),await s.LocalStorage.setItem("Preferred App",JSON.stringify(a)),p(Date.now())}}),(0,u.jsx)(s.Action,{title:`Reset ${i.name} Rank`,icon:s.Icon.ArrowClockwise,shortcut:{modifiers:["cmd"],key:"r"},onAction:async()=>{await Q(s.Icon.Trash,`Reset ${i.name} Rank`,`Are you sure you want to reset ${i.name} rank?`,"Reset",async()=>{await ht(i,o),p(Date.now()),await(0,s.showToast)(s.Toast.Style.Success,`Rank of ${i.name} Reset!`)})}}),(0,u.jsx)(s.Action,{title:"Reset All Rank",icon:s.Icon.ExclamationMark,shortcut:{modifiers:["shift","cmd"],key:"r"},onAction:async()=>{await Q(s.Icon.Trash,"Reset All Rank","Are you sure you want to reset all rank?","Reset All",async()=>{await At(o),p(Date.now()),await(0,s.showToast)(s.Toast.Style.Success,"Rank of All Reset!")})}})]})]}),(0,u.jsx)(s.ActionPanel.Section,{children:(0,u.jsx)(s.Action.ToggleQuickLook,{shortcut:{modifiers:["cmd"],key:"y"}})}),(0,u.jsx)(P,{})]})}var Y=require("react/jsx-runtime");function F(e){let{isCustom:t,itemInput:n,setRefresh:i,index:o,openLinkApplications:r}=e,p=r[o];return(0,Y.jsx)(gt.List.Item,{title:p.name,icon:{fileIcon:p.path},quickLook:{path:p.path,name:p.name},actions:(0,Y.jsx)(W,{isCustom:t,index:o,openLinkApplication:p,openLinkApplications:r,itemInput:n,setRefresh:i})})}var d=require("@raycast/api");var w=require("react/jsx-runtime");function H(){let{layout:e}=(0,d.getPreferenceValues)();return e==="List"?(0,w.jsx)(d.List.EmptyView,{icon:{source:{light:"empty-icon.svg",dark:"empty-icon@dark.svg"}},title:"No Application",actions:(0,w.jsx)(d.ActionPanel,{children:(0,w.jsx)(P,{})})}):(0,w.jsx)(d.Grid.EmptyView,{icon:{source:{light:"empty-icon.svg",dark:"empty-icon@dark.svg"}},title:"No Application",actions:(0,w.jsx)(d.ActionPanel,{children:(0,w.jsx)(P,{})})})}var f=require("react/jsx-runtime");function Ot(e){let{showAll:t}=(0,m.getPreferenceValues)(),{buildInApps:n,customApps:i,otherApps:o,itemInput:r,setRefresh:p,loading:a}=e;return(0,f.jsxs)(m.List,{isLoading:a,searchBarPlaceholder:N(r),children:[(0,f.jsx)(H,{}),(0,f.jsx)(m.List.Section,{title:"Favorites",children:i.map((L,R)=>(0,f.jsx)(F,{isCustom:!0,itemInput:r,setRefresh:p,index:R,openLinkApplications:i},L.path))}),(0,f.jsx)(m.List.Section,{title:"Recommended",children:n.map((L,R)=>(0,f.jsx)(F,{isCustom:!1,itemInput:r,setRefresh:p,index:R,openLinkApplications:n},L.path))}),!a&&(0,f.jsx)(m.List.Section,{title:"Type: "+r.type+"  Source: "+r.source,children:(0,f.jsx)(m.List.Item,{id:"Type",title:r.content,icon:m.Icon.Text,accessories:[{text:"WordCount  "+r.content.length}],actions:(0,f.jsxs)(m.ActionPanel,{children:[(0,f.jsx)(m.Action,{title:M(r,"Default Browser"),icon:_(r),onAction:async()=>{r.type===""?p(Date.now()):(await(0,m.showHUD)("Search in default browser"),await(0,m.open)(K(r)))}}),(0,f.jsx)(P,{})]})})}),t&&(0,f.jsx)(m.List.Section,{title:"Other",subtitle:"Press \u2318+S to add app to Favorites",children:o.map((L,R)=>(0,f.jsx)(F,{isCustom:!1,itemInput:r,setRefresh:p,index:R,openLinkApplications:o},L.path))})]})}var x=require("@raycast/api");var St=require("@raycast/api");var j=require("react/jsx-runtime");function V(e){let{isCustom:t,itemInput:n,setRefresh:i,index:o,openLinkApplications:r}=e,p=r[o];return(0,j.jsx)(St.Grid.Item,{title:p.name,content:{fileIcon:p.path},quickLook:{path:p.path,name:p.name},actions:(0,j.jsx)(W,{isCustom:t,index:o,openLinkApplication:p,openLinkApplications:r,itemInput:n,setRefresh:i})})}var I=require("react/jsx-runtime");function Pt(e){let{columns:t,itemInset:n,showAll:i}=(0,x.getPreferenceValues)(),{buildInApps:o,customApps:r,otherApps:p,itemInput:a,setRefresh:L,loading:R}=e;return(0,I.jsxs)(x.Grid,{columns:parseInt(t),inset:E(n)?void 0:n,isLoading:R,searchBarPlaceholder:N(a),children:[(0,I.jsx)(H,{}),(0,I.jsx)(x.Grid.Section,{title:"Favorites",children:r.map((y,g)=>(0,I.jsx)(V,{isCustom:!0,itemInput:a,setRefresh:L,index:g,openLinkApplications:r},y.path))}),(0,I.jsx)(x.Grid.Section,{title:"Recommended",children:o.map((y,g)=>(0,I.jsx)(V,{isCustom:!1,itemInput:a,setRefresh:L,index:g,openLinkApplications:o},y.path))}),i&&(0,I.jsx)(x.Grid.Section,{title:"Other",subtitle:"Press \u2318+S to add app to Favorites",children:p.map((y,g)=>(0,I.jsx)(V,{isCustom:!1,itemInput:a,setRefresh:L,index:g,openLinkApplications:p},y.path))})]})}var tt=require("react/jsx-runtime");function xt(){let{layout:e}=(0,Tt.getPreferenceValues)(),[t,n]=(0,wt.useState)(0),{itemInput:i}=Et(t),{buildInApps:o,customApps:r,otherApps:p,loading:a}=yt(i,t);return e==="List"?(0,tt.jsx)(Ot,{buildInApps:o,customApps:r,otherApps:p,itemInput:i,setRefresh:n,loading:a}):(0,tt.jsx)(Pt,{buildInApps:o,customApps:r,otherApps:p,itemInput:i,setRefresh:n,loading:a})}
